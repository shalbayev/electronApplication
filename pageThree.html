<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="design.css">
  <title>Page Three</title>
</head>
<body>
  <h1>Page three!!!</h1>
  <div class="content">
    <button type="button" name="button" id='openFile'>Open</button>
  </div>
  <select id="dynamic-select">

    </select>

    <button id="addFile">add item</button>

</body>

<script>
var item_select = document.getElementById('dynamic-select')

var btn = document.getElementById('openFile')
var add = document.getElementById('addFile')
const remote = require('electron').remote
const ipcMain = require('electron').ipcMain
const fs=require('fs')
let categories = fs.readdirSync('./categories')
for(let category of categories){
  option='<option>'+category+'</option>'
  item_select.innerHTML+=option

}

const main = remote.require('./app.js')
const dialog=remote.dialog
const an_dialog=remote.dialog
let filePaths=[]

    btn.addEventListener('click',()=>{
      dialog.showOpenDialog({
        properties:['openFile'],
        filters:[
          { name: 'Изображения', extensions: ['jpg', 'png', 'gif'] },

        ]
      }
    ).then(result=>{
      filePaths=result.filePaths;
      read_image()
    })
    })
    function read_image() {
      fs.readFile(filePaths[0],(err,data)=>{
        if(err)
          console.log(err);
        save_image(data)
      })

    }
    function get_fileName(path){
      var fileName=fs.readdirSync(path)



      console.log(fileName);
      return path + "/" + (fileName.length + 1)
    }
    function save_image(image_data) {
      let vaf = filePaths[0].split("\\")
      let word = vaf[vaf.length-1]
      let res = word.split('.')
      let extension=res[res.length-1]
      console.log(extension);
      let fileName = get_fileName('./')


        fs.writeFile(fileName +"."+ extension,image_data,(err)=>{
          if(err)
            return console.log(err);
          console.log('success');
          console.log(filePaths[0])
        })


    }

  </script>

</html>
